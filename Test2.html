<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Band Inventory Test</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 1rem; }
    .menu-icon { font-size: 1.5rem; cursor: pointer; }
    #menuOverlay { display: none; position: fixed; top: 0; left: 0; width: 100%; 
      height: 100%; background: rgba(0,0,0,0.8); color: white; padding: 2rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #444; padding: 6px; text-align: center; }
    th { background-color: #ddd; }
    img { width: 50px; height: auto; }
    form label { display: block; margin: 0.5rem 0; }
  </style>
</head>
<body>
  <span class="menu-icon" onclick="toggleMenu()">☰ Menu</span>
  <div id="menuOverlay">
    <button onclick="toggleView('inventory')">Inventory</button>
    <button onclick="toggleView('discounts')">Discounts</button>
    <button onclick="toggleMenu()">Close ×</button>
  </div>

  <div id="inventorySection">
    <h2>Add Product</h2>
    <form id="productForm">
      <label>Category: <input type="text" id="productCategory" required></label>
      <label>Name:     <input type="text" id="productName" required></label>
      <label>Image URL:<input type="url" id="productImage"></label>
      <label>Size:     <input type="text" id="productSize" required></label>
      <label>Qty:      <input type="number" id="productQty" required></label>
      <label>
        Gender:
        <input type="checkbox" id="productGenderMale" onchange="toggleGender('M')"> M
        <input type="checkbox" id="productGenderFemale" onchange="toggleGender('F')"> F
      </label>
      <button type="submit">Add Product</button>
    </form>

    <h2>Inventory</h2>
    <table>
      <thead>
        <tr><th>Category</th><th>Name</th><th>Image</th><th>Size</th><th>Qty</th><th>Actions</th></tr>
      </thead>
      <tbody id="inventoryTableBody"></tbody>
    </table>
  </div>

  <div id="discountSection" style="display:none;">
    <h2>Discounts</h2>
    <p>Discounts section placeholder</p>
  </div>

  <script>
    function toggleMenu() {
      const m = document.getElementById("menuOverlay");
      m.style.display = m.style.display === "block" ? "none" : "block";
    }
    function toggleView(view) {
      document.getElementById("inventorySection").style.display = view === "inventory" ? "block" : "none";
      document.getElementById("discountSection").style.display = view === "discounts" ? "block" : "none";
      toggleMenu();
    }
    function toggleGender(sel) {
      const m = document.getElementById("productGenderMale"), f = document.getElementById("productGenderFemale");
      if (sel === "M" && m.checked) f.checked = false;
      if (sel === "F" && f.checked) m.checked = false;
    }

    window.addEventListener("DOMContentLoaded", function(){
      renderInventory();
      document.getElementById("productForm").addEventListener("submit", function(e){
        e.preventDefault();
        const cat = document.getElementById("productCategory").value.trim();
        const name = document.getElementById("productName").value.trim();
        const img  = document.getElementById("productImage").value.trim();
        const size = document.getElementById("productSize").value.trim();
        const qty  = parseInt(document.getElementById("productQty").value);
        const male = document.getElementById("productGenderMale").checked;
        const female= document.getElementById("productGenderFemale").checked;
        if (!cat||!name||!size|| isNaN(qty)) return;
        const inv = JSON.parse(localStorage.getItem("products")|| "{}");
        if (!inv[cat]) inv[cat]={};
        if (!inv[cat][name]) inv[cat][name]={sizes:{}, image:img, gender: male?"M":female?"F":""};
        inv[cat][name].sizes[size] = (inv[cat][name].sizes[size]||0) + qty;
        inv[cat][name].image = img;
        inv[cat][name].gender = male?"M":female?"F":"";
        localStorage.setItem("products", JSON.stringify(inv));
        renderInventory();
        this.reset();
      });
    });

    function renderInventory(){
      const inv = JSON.parse(localStorage.getItem("products")|| "{}"), tbody = document.getElementById("inventoryTableBody");
      tbody.innerHTML="";
      for(const cat in inv){
        for(const nm in inv[cat]){
          const p = inv[cat][nm];
          for(const sz in p.sizes){
            const qty = p.sizes[sz];
            const tr = document.createElement("tr");
            tr.innerHTML=`<td>${cat}</td><td>${nm}</td>
              <td>${p.image?`<img src="${p.image}">`:""}</td>
              <td>${sz}</td><td>${qty}</td>
              <td><button>Edit</button><button>Delete</button></td>`;
            tbody.appendChild(tr);
          }
        }
      }
    }
  </script>
</body>
</html>