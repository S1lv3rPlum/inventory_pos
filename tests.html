<!DOCTYPE html><html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Inventory Management</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        h2 {
            margin-top: 40px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .category-header {
            background-color: #e0e0e0;
            font-weight: bold;
        }
        .hidden {
            display: none;
        }
        .tab-button {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <button class="tab-button" onclick="showSection('product-section')">Products</button>
    <button class="tab-button" onclick="showSection('discount-section')">Discounts</button><div id="product-section">
    <h2>Add Product</h2>
    <form id="product-form">
        <input type="text" id="product-name" placeholder="Product Name" required>
        <input type="text" id="product-category" placeholder="Category" required>
        <input type="number" id="product-cost" placeholder="Cost" required>
        <label><input type="checkbox" id="product-sizes"> Has Sizes</label>
        <button type="submit">Add Product</button>
    </form>

    <h2>Product List</h2>
    <table id="product-table"></table>
</div>

<div id="discount-section" class="hidden">
    <h2>Add Discount</h2>
    <form id="discount-form">
        <input type="text" id="discount-name" placeholder="Discount Name" required>
        <select id="discount-type">
            <option value="%">%</option>
            <option value="$">$</option>
        </select>
        <input type="number" id="discount-value" placeholder="Value" required>
        <button type="submit">Add Discount</button>
    </form>

    <h2>Discount List</h2>
    <table id="discount-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Value</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
    let products = [];
    let discounts = [];

    document.getElementById('product-form').addEventListener('submit', function(event) {
        event.preventDefault();
        const name = document.getElementById('product-name').value;
        const category = document.getElementById('product-category').value;
        const cost = parseFloat(document.getElementById('product-cost').value);
        const hasSizes = document.getElementById('product-sizes').checked;
        const sizes = hasSizes ? { S: 0, M: 0, L: 0, XL: 0 } : null;
        products.push({ name, category, cost, sizes });
        this.reset();
        renderProductTable();
    });

    document.getElementById('discount-form').addEventListener('submit', function(event) {
        event.preventDefault();
        const name = document.getElementById('discount-name').value;
        const type = document.getElementById('discount-type').value;
        const value = parseFloat(document.getElementById('discount-value').value);
        discounts.push({ name, type, value });
        this.reset();
        renderDiscountTable();
    });

    function renderProductTable() {
        const table = document.getElementById('product-table');
        table.innerHTML = '';
        if (products.length === 0) return;

        const grouped = {};
        products.forEach(p => {
            if (!grouped[p.category]) grouped[p.category] = [];
            grouped[p.category].push(p);
        });

        const headerRow = document.createElement('tr');
        headerRow.innerHTML = '<th>Product</th><th>Cost</th>';
        const sizes = Object.keys(products.find(p => p.sizes)?.sizes || {});
        sizes.forEach(size => headerRow.innerHTML += `<th>${size}</th>`);
        headerRow.innerHTML += '<th>Action</th>';
        table.appendChild(headerRow);

        Object.keys(grouped).sort().forEach(category => {
            const catRow = document.createElement('tr');
            const catCell = document.createElement('td');
            catCell.colSpan = sizes.length + 3;
            catCell.className = 'category-header';
            catCell.textContent = category;
            catRow.appendChild(catCell);
            table.appendChild(catRow);

            grouped[category].sort((a, b) => a.name.localeCompare(b.name)).forEach((p, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td contenteditable="true">${p.name}</td>
                    <td contenteditable="true">${p.cost}</td>
                    ${sizes.map(size => `<td contenteditable="true">${p.sizes?.[size] ?? ''}</td>`).join('')}
                    <td>
                        <button onclick="editRow(this)">Edit</button>
                        <button onclick="deleteProduct('${category}', '${p.name}')">Delete</button>
                    </td>
                `;
                table.appendChild(row);
            });
        });
    }

    function renderDiscountTable() {
        const tbody = document.querySelector('#discount-table tbody');
        tbody.innerHTML = '';
        discounts.forEach((d, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td contenteditable="true">${d.name}</td>
                <td>${d.type}</td>
                <td contenteditable="true">${d.value}</td>
                <td><button onclick="deleteDiscount(${index})">Delete</button></td>
            `;
            tbody.appendChild(row);
        });
    }

    function deleteProduct(category, name) {
        products = products.filter(p => !(p.category === category && p.name === name));
        renderProductTable();
    }

    function deleteDiscount(index) {
        discounts.splice(index, 1);
        renderDiscountTable();
    }

    function editRow(btn) {
        const row = btn.closest('tr');
        const cells = row.querySelectorAll('td');
        const values = Array.from(cells).slice(0, -1).map(td => td.textContent);
        const categoryRow = row.previousElementSibling;
        const category = categoryRow.textContent;
        const index = products.findIndex(p => p.category === category && p.name === values[0]);
        if (index !== -1) {
            products[index].name = values[0];
            products[index].cost = parseFloat(values[1]);
            if (products[index].sizes) {
                Object.keys(products[index].sizes).forEach((size, i) => {
                    products[index].sizes[size] = parseInt(values[2 + i]) || 0;
                });
            }
            renderProductTable();
        }
    }

    function showSection(id) {
        document.getElementById('product-section').classList.add('hidden');
        document.getElementById('discount-section').classList.add('hidden');
        document.getElementById(id).classList.remove('hidden');
    }
</script>

</body>
</html>