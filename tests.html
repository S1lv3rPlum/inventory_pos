<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product & Discount Manager</title>
  <style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      padding: 8px;
    }
    .hidden {
      display: none;
    }
    .category-header {
      background-color: #f0f0f0;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>Product Manager</h2>
  <form id="productForm">
    <input type="text" id="name" placeholder="Product Name" required />
    <input type="text" id="category" placeholder="Category" required />
    <input type="number" id="price" placeholder="Price ($)" required />
    <label><input type="checkbox" id="hasSizes" /> Has Sizes</label>
    <button type="submit">Add Product</button>
  </form><button onclick="toggleView('product')">Products</button> <button onclick="toggleView('discount')">Discounts</button> <button onclick="exportToExcel('productTable', 'products.xlsx')">Export Products</button> <input type="file" accept=".xlsx" onchange="importFromExcel(event, 'product')" />

  <div id="productSection">
    <table id="productTable"></table>
  </div>  <div id="discountSection" class="hidden">
    <form id="discountForm">
      <input type="text" id="discountName" placeholder="Discount Name" required />
      <select id="discountType" required>
        <option value="%">% Off</option>
        <option value="$">$ Off</option>
      </select>
      <input type="number" id="discountAmount" placeholder="Amount" required />
      <button type="submit">Add Discount</button>
    </form><button onclick="exportToExcel('discountTable', 'discounts.xlsx')">Export Discounts</button>
<input type="file" accept=".xlsx" onchange="importFromExcel(event, 'discount')" />

<table id="discountTable">
  <thead>
    <tr><th>Name</th><th>Type</th><th>Amount</th><th>Actions</th></tr>
  </thead>
  <tbody></tbody>
</table>

  </div>  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>  <script>
    let products = JSON.parse(localStorage.getItem('products')) || [];
    let discounts = JSON.parse(localStorage.getItem('discounts')) || [];

    const productForm = document.getElementById('productForm');
    const discountForm = document.getElementById('discountForm');
    const productTable = document.getElementById('productTable');
    const discountTableBody = document.querySelector('#discountTable tbody');

    function toggleView(section) {
      document.getElementById('productSection').classList.toggle('hidden', section !== 'product');
      document.getElementById('discountSection').classList.toggle('hidden', section !== 'discount');
    }

    productForm.onsubmit = function(e) {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const category = document.getElementById('category').value;
      const price = parseFloat(document.getElementById('price').value);
      const hasSizes = document.getElementById('hasSizes').checked;
      const sizes = hasSizes ? { XS: 0, S: 0, M: 0, L: 0, XL: 0, '2XL': 0, '3XL': 0, '4XL': 0 } : null;
      products.push({ name, category, price, sizes });
      saveAndRenderProducts();
      productForm.reset();
    }

    discountForm.onsubmit = function(e) {
      e.preventDefault();
      const name = document.getElementById('discountName').value;
      const type = document.getElementById('discountType').value;
      const amount = parseFloat(document.getElementById('discountAmount').value);
      discounts.push({ name, type, amount });
      localStorage.setItem('discounts', JSON.stringify(discounts));
      renderDiscounts();
      discountForm.reset();
    }

    function saveAndRenderProducts() {
      localStorage.setItem('products', JSON.stringify(products));
      renderProducts();
    }

    function renderProducts() {
      productTable.innerHTML = '';
      const sorted = [...products].sort((a, b) => a.category.localeCompare(b.category) || a.name.localeCompare(b.name));
      let currentCategory = '';
      sorted.forEach((p, index) => {
        if (p.category !== currentCategory) {
          currentCategory = p.category;
          const headerRow = productTable.insertRow();
          const headerCell = headerRow.insertCell();
          headerCell.colSpan = 4;
          headerCell.textContent = currentCategory;
          headerCell.classList.add('category-header');
        }
        const row = productTable.insertRow();
        row.innerHTML = `
          <td contenteditable="true">${p.name}</td>
          <td contenteditable="true">${p.price}</td>
          <td>${p.sizes ? JSON.stringify(p.sizes) : ''}</td>
          <td><button onclick="deleteProduct(${index})">Delete</button></td>
        `;
        row.oninput = () => {
          const cells = row.querySelectorAll('td');
          products[index].name = cells[0].innerText;
          products[index].price = parseFloat(cells[1].innerText);
          saveAndRenderProducts();
        }
      });
    }

    function renderDiscounts() {
      discountTableBody.innerHTML = '';
      discounts.forEach((d, index) => {
        const row = discountTableBody.insertRow();
        row.innerHTML = `
          <td contenteditable="true">${d.name}</td>
          <td contenteditable="true">${d.type}</td>
          <td contenteditable="true">${d.amount}</td>
          <td><button onclick="deleteDiscount(${index})">Delete</button></td>
        `;
        row.oninput = () => {
          const cells = row.querySelectorAll('td');
          discounts[index].name = cells[0].innerText;
          discounts[index].type = cells[1].innerText;
          discounts[index].amount = parseFloat(cells[2].innerText);
          localStorage.setItem('discounts', JSON.stringify(discounts));
        }
      });
    }

    function deleteProduct(index) {
      products.splice(index, 1);
      saveAndRenderProducts();
    }

    function deleteDiscount(index) {
      discounts.splice(index, 1);
      localStorage.setItem('discounts', JSON.stringify(discounts));
      renderDiscounts();
    }

    function exportToExcel(tableId, filename) {
      const table = document.getElementById(tableId);
      const wb = XLSX.utils.table_to_book(table);
      XLSX.writeFile(wb, filename);
    }

    function importFromExcel(event, type) {
      const file = event.target.files[0];
      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const rows = XLSX.utils.sheet_to_json(sheet);
        if (type === 'product') {
          products = rows.map(r => ({
            name: r['Name'],
            category: r['Category'],
            price: parseFloat(r['Price']),
            sizes: r['Sizes'] ? JSON.parse(r['Sizes']) : null
          }));
          saveAndRenderProducts();
        } else {
          discounts = rows.map(r => ({
            name: r['Name'],
            type: r['Type'],
            amount: parseFloat(r['Amount'])
          }));
          localStorage.setItem('discounts', JSON.stringify(discounts));
          renderDiscounts();
        }
      }
      reader.readAsArrayBuffer(file);
    }

    // Initial render
    renderProducts();
    renderDiscounts();
  </script></body>
</html>