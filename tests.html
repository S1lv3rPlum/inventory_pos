<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Inventory Manager</title>
  <style>
    body { font-family: Arial; margin: 20px; }
    label { display: block; margin-top: 10px; }
    .size-qty { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
    .size-qty input { width: 60px; }
  </style>
</head>
<body>
  <h2>Add Product</h2>
  <form id="addProductForm">
    <label>
      Category:
      <input type="text" id="category" required>
    </label>
    <label>
      Name:
      <input type="text" id="name" required>
    </label>
    <label>
      Image URL:
      <input type="url" id="image">
    </label>
    <label>
      Has Sizes?
      <input type="checkbox" id="hasSizes">
    </label>

    <div id="sizeInputs" class="size-qty" style="display:none;">
      <label>S: <input type="number" min="0" id="qty_S" value="0"></label>
      <label>M: <input type="number" min="0" id="qty_M" value="0"></label>
      <label>L: <input type="number" min="0" id="qty_L" value="0"></label>
      <label>XL: <input type="number" min="0" id="qty_XL" value="0"></label>
      <label>2XL: <input type="number" min="0" id="qty_2XL" value="0"></label>
    </div>

    <div id="singleQtyContainer">
      <label>
        Quantity:
        <input type="number" min="0" id="singleQty" value="0">
      </label>
    </div>

    <button type="submit">Add Product</button>
  </form>

  <h2>Inventory</h2>
  <table border="1">
    <thead>
      <tr>
        <th>Category</th>
        <th>Name</th>
        <th>Image</th>
        <th>Size</th>
        <th>Qty</th>
      </tr>
    </thead>
    <tbody id="inventoryTableBody"></tbody>
  </table>

  <script>
    const hasSizesCheckbox = document.getElementById("hasSizes");
    const sizeInputs = document.getElementById("sizeInputs");
    const singleQtyContainer = document.getElementById("singleQtyContainer");

    hasSizesCheckbox.addEventListener("change", () => {
      if (hasSizesCheckbox.checked) {
        sizeInputs.style.display = "flex";
        singleQtyContainer.style.display = "none";
      } else {
        sizeInputs.style.display = "none";
        singleQtyContainer.style.display = "block";
      }
    });

    document.getElementById("addProductForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const category = document.getElementById("category").value.trim();
      const name = document.getElementById("name").value.trim();
      const image = document.getElementById("image").value.trim();
      const hasSizes = hasSizesCheckbox.checked;

      const inventory = JSON.parse(localStorage.getItem("products") || "{}");

      if (!inventory[category]) inventory[category] = {};
      if (!inventory[category][name]) inventory[category][name] = { sizes: {}, image };

      if (hasSizes) {
        const sizes = ["S", "M", "L", "XL", "2XL"];
        sizes.forEach(size => {
          const qty = parseInt(document.getElementById("qty_" + size).value || "0", 10);
          inventory[category][name].sizes[size] = qty;
        });
      } else {
        const qty = parseInt(document.getElementById("singleQty").value || "0", 10);
        inventory[category][name].sizes[""] = qty; // store with blank size
      }

      localStorage.setItem("products", JSON.stringify(inventory));
      loadInventoryTable();
      this.reset();
      sizeInputs.style.display = "none";
      singleQtyContainer.style.display = "block";
    });

    function loadInventoryTable() {
      const tableBody = document.getElementById("inventoryTableBody");
      const inventory = JSON.parse(localStorage.getItem("products") || "{}");
      tableBody.innerHTML = "";

      for (const category in inventory) {
        for (const name in inventory[category]) {
          const product = inventory[category][name];
          const sizes = product.sizes || {};
          for (const size in sizes) {
            const row = document.createElement("tr");
            row.innerHTML = `
              <td>${category}</td>
              <td>${name}</td>
              <td>${product.image ? `<img src="${product.image}" style="width:50px;">` : "No Image"}</td>
              <td>${size || "N/A"}</td>
              <td>${sizes[size]}</td>
            `;
            tableBody.appendChild(row);
          }
        }
      }
    }

    window.addEventListener("DOMContentLoaded", loadInventoryTable);
  </script>
</body>
</html>