<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Inventory POS</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="menuToggle">&#9776;</div>
  <div id="menuOverlay">
    <button onclick="toggleView('inventory')">Inventory</button>
    <button onclick="toggleView('discounts')">Discounts</button>
  </div>

  <section id="inventorySection">
    <h1>Add Product</h1>
    <form id="productForm">
      <input type="text" id="productCategory" placeholder="Category" required>
      <input type="text" id="productName" placeholder="Name" required>
      <input type="url" id="productImage" placeholder="Image URL">
      <input type="text" id="productSize" placeholder="Size" required>
      <input type="number" id="productQty" placeholder="Qty" required>
      <label>
        <input type="checkbox" id="productGenderMale" onchange="toggleGender('M')"> Male
      </label>
      <label>
        <input type="checkbox" id="productGenderFemale" onchange="toggleGender('F')"> Female
      </label>
      <button type="submit">Add Product</button>
    </form>

    <h2>Inventor2y</h2>
    <table>
      <thead>
        <tr>
          <th>Category</th>
          <th>Name</th>
          <th>Image</th>
          <th>Size</th>
          <th>Qty</th>
        </tr>
      </thead>
      <tbody id="inventoryTableBody"></tbody>
    </table>
  </section>

  <section id="discountSection" style="display:none;">
    <h1>Discounts</h1>
    <div id="discountList">Coming soon...</div>
  </section>

  <script>
    function toggleView(view) {
      document.getElementById("inventorySection").style.display = view === "inventory" ? "block" : "none";
      document.getElementById("discountSection").style.display = view === "discounts" ? "block" : "none";
    }

    function toggleGender(selected) {
      const male = document.getElementById("productGenderMale");
      const female = document.getElementById("productGenderFemale");
      if (selected === "M" && male.checked) {
        female.checked = false;
      } else if (selected === "F" && female.checked) {
        male.checked = false;
      }
    }

    // Menu overlay
    document.getElementById("menuToggle").addEventListener("click", () => {
      const menu = document.getElementById("menuOverlay");
      menu.style.display = menu.style.display === "block" ? "none" : "block";
    });

    // Load inventory from localStorage
    window.addEventListener('DOMContentLoaded', function () {
      const inventory = JSON.parse(localStorage.getItem('products')) || {};
      const tableBody = document.getElementById('inventoryTableBody');
      tableBody.innerHTML = '';

      for (const category in inventory) {
        const products = inventory[category];

        for (const productName in products) {
          const product = products[productName];
          const sizes = product.sizes || {};
          const imageURL = product.image || '';

          for (const size in sizes) {
            const qty = sizes[size];

            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${category}</td>
              <td>${productName}</td>
              <td>
                ${imageURL ? `<img src="${imageURL}" alt="${productName}" style="width:50px;height:auto;">` : 'No Image'}
              </td>
              <td>${size}</td>
              <td>${qty}</td>
            `;
            tableBody.appendChild(row);
          }
        }
      }
    });

    // Add product logic
    document.getElementById("productForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const category = document.getElementById("productCategory").value.trim();
      const name = document.getElementById("productName").value.trim();
      const image = document.getElementById("productImage").value.trim();
      const size = document.getElementById("productSize").value.trim();
      const qty = parseInt(document.getElementById("productQty").value.trim());
      const male = document.getElementById("productGenderMale").checked;
      const female = document.getElementById("productGenderFemale").checked;

      if (!category || !name || !size || isNaN(qty)) return;

      const inventory = JSON.parse(localStorage.getItem("products")) || {};
      if (!inventory[category]) inventory[category] = {};
      if (!inventory[category][name]) {
        inventory[category][name] = {
          sizes: {},
          image: image,
          gender: male ? "M" : female ? "F" : ""
        };
      }

      inventory[category][name].sizes[size] = (inventory[category][name].sizes[size] || 0) + qty;
      localStorage.setItem("products", JSON.stringify(inventory));
      location.reload(); // reload so the table updates
    });
  </script>
</body>
</html>