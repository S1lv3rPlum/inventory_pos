<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inventory Manager</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    h1 {
      margin-bottom: 10px;
    }
    .button-row {
      margin-bottom: 20px;
    }
    button {
      margin-right: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    .category-header {
      background-color: #ccc;
      font-weight: bold;
      text-align: center;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <h1>Inventory Manager</h1>  <div class="button-row">
    <button onclick="showProductForm()">Inventory</button>
    <button onclick="showDiscountForm()">Discounts</button>
    <button onclick="exportToExcel()">Export</button>
    <input type="file" id="importFile" onchange="importFromExcel(event)" />
  </div>  <h2 id="form-title">Product Manager</h2>  <!-- Product Form -->  <div id="product-form">
    <input type="text" id="productName" placeholder="Product Name" />
    <input type="text" id="productCategory" placeholder="Category" />
    <input type="number" id="productCost" placeholder="Cost" />
    <label><input type="checkbox" id="hasSizes" onchange="toggleSizes()" /> Has Sizes</label>
    <div id="sizeInputs" class="hidden">
      <input type="number" placeholder="XS" id="sizeXS" />
      <input type="number" placeholder="S" id="sizeS" />
      <input type="number" placeholder="M" id="sizeM" />
      <input type="number" placeholder="L" id="sizeL" />
      <input type="number" placeholder="XL" id="sizeXL" />
      <input type="number" placeholder="2XL" id="size2XL" />
      <input type="number" placeholder="3XL" id="size3XL" />
      <input type="number" placeholder="4XL" id="size4XL" />
    </div>
    <button onclick="addProduct()">Add Product</button>
  </div>  <!-- Discount Form -->  <div id="discount-form" class="hidden">
    <input type="text" id="discountName" placeholder="Discount Name" />
    <input type="text" id="discountType" placeholder="Type" />
    <input type="number" id="discountAmount" placeholder="Amount" />
    <select id="discountUnit">
      <option value="%">%</option>
      <option value="$">$</option>
    </select>
    <button onclick="addDiscount()">Add Discount</button>
  </div>  <div id="product-table-section"></div>
  <div id="discount-table-section" class="hidden"></div>  <script>
    let inventory = JSON.parse(localStorage.getItem("inventory")) || [];
    let discounts = JSON.parse(localStorage.getItem("discounts")) || [];

    function saveData() {
      localStorage.setItem("inventory", JSON.stringify(inventory));
      localStorage.setItem("discounts", JSON.stringify(discounts));
    }

    function showProductForm() {
      document.getElementById("product-form").classList.remove("hidden");
      document.getElementById("discount-form").classList.add("hidden");
      document.getElementById("product-table-section").classList.remove("hidden");
      document.getElementById("discount-table-section").classList.add("hidden");
      document.getElementById("form-title").innerText = "Product Manager";
      renderProductTable();
    }

    function showDiscountForm() {
      document.getElementById("product-form").classList.add("hidden");
      document.getElementById("discount-form").classList.remove("hidden");
      document.getElementById("product-table-section").classList.add("hidden");
      document.getElementById("discount-table-section").classList.remove("hidden");
      document.getElementById("form-title").innerText = "Discount Manager";
      renderDiscountTable();
    }

    function toggleSizes() {
      const sizeDiv = document.getElementById("sizeInputs");
      sizeDiv.classList.toggle("hidden", !document.getElementById("hasSizes").checked);
    }

    function addProduct() {
      const name = document.getElementById("productName").value;
      const category = document.getElementById("productCategory").value;
      const cost = parseFloat(document.getElementById("productCost").value);
      const sizes = document.getElementById("hasSizes").checked ? {
        XS: +document.getElementById("sizeXS").value || 0,
        S: +document.getElementById("sizeS").value || 0,
        M: +document.getElementById("sizeM").value || 0,
        L: +document.getElementById("sizeL").value || 0,
        XL: +document.getElementById("sizeXL").value || 0,
        '2XL': +document.getElementById("size2XL").value || 0,
        '3XL': +document.getElementById("size3XL").value || 0,
        '4XL': +document.getElementById("size4XL").value || 0,
      } : null;
      inventory.push({ name, category, cost, sizes });
      saveData();
      renderProductTable();
    }

    function renderProductTable() {
      const grouped = {};
      inventory.forEach(item => {
        if (!grouped[item.category]) grouped[item.category] = [];
        grouped[item.category].push(item);
      });

      let html = '<table><thead><tr><th>Product</th><th>Cost</th>';
      html += '<th>XS</th><th>S</th><th>M</th><th>L</th><th>XL</th><th>2XL</th><th>3XL</th><th>4XL</th>';
      html += '<th>Action</th></tr></thead><tbody>';

      Object.entries(grouped).forEach(([category, items]) => {
        html += `<tr class="category-header"><td colspan="11">${category}</td></tr>`;
        items.forEach((item, index) => {
          html += `<tr>
            <td contenteditable="true">${item.name}</td>
            <td contenteditable="true">${item.cost}</td>
            <td contenteditable="true">${item.sizes?.XS || 0}</td>
            <td contenteditable="true">${item.sizes?.S || 0}</td>
            <td contenteditable="true">${item.sizes?.M || 0}</td>
            <td contenteditable="true">${item.sizes?.L || 0}</td>
            <td contenteditable="true">${item.sizes?.XL || 0}</td>
            <td contenteditable="true">${item.sizes?.['2XL'] || 0}</td>
            <td contenteditable="true">${item.sizes?.['3XL'] || 0}</td>
            <td contenteditable="true">${item.sizes?.['4XL'] || 0}</td>
            <td>
              <button onclick="saveEdit(${index})">Save</button>
              <button onclick="deleteProduct(${index})">Delete</button>
            </td>
          </tr>`;
        });
      });

      html += '</tbody></table>';
      document.getElementById("product-table-section").innerHTML = html;
    }

    function saveEdit(index) {
      const rows = document.querySelectorAll("#product-table-section table tbody tr:not(.category-header)");
      const row = rows[index];
      const cells = row.querySelectorAll("td");
      inventory[index].name = cells[0].innerText;
      inventory[index].cost = parseFloat(cells[1].innerText);
      inventory[index].sizes = {
        XS: +cells[2].innerText,
        S: +cells[3].innerText,
        M: +cells[4].innerText,
        L: +cells[5].innerText,
        XL: +cells[6].innerText,
        '2XL': +cells[7].innerText,
        '3XL': +cells[8].innerText,
        '4XL': +cells[9].innerText,
      };
      saveData();
    }

    function deleteProduct(index) {
      inventory.splice(index, 1);
      saveData();
      renderProductTable();
    }

    function addDiscount() {
      const name = document.getElementById("discountName").value;
      const type = document.getElementById("discountType").value;
      const amount = parseFloat(document.getElementById("discountAmount").value);
      const unit = document.getElementById("discountUnit").value;
      discounts.push({ name, type, amount, unit });
      saveData();
      renderDiscountTable();
    }

    function renderDiscountTable() {
      const grouped = {};
      discounts.forEach(item => {
        if (!grouped[item.type]) grouped[item.type] = [];
        grouped[item.type].push(item);
      });

      let html = '<table><thead><tr><th>Name</th><th>Amount</th><th>Unit</th><th>Action</th></tr></thead><tbody>';

      Object.entries(grouped).forEach(([type, items]) => {
        html += `<tr class="category-header"><td colspan="4">${type}</td></tr>`;
        items.forEach((item, index) => {
          html += `<tr>
            <td contenteditable="true">${item.name}</td>
            <td contenteditable="true">${item.amount}</td>
            <td contenteditable="true">${item.unit}</td>
            <td>
              <button onclick="deleteDiscount(${index})">Delete</button>
            </td>
          </tr>`;
        });
      });

      html += '</tbody></table>';
      document.getElementById("discount-table-section").innerHTML = html;
    }

    function deleteDiscount(index) {
      discounts.splice(index, 1);
      saveData();
      renderDiscountTable();
    }

    function exportToExcel() {
      const data = { inventory, discounts };
      const blob = new Blob([JSON.stringify(data)], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "inventory_export.json";
      a.click();
      URL.revokeObjectURL(url);
    }

    function importFromExcel(event) {
      const file = event.target.files[0];
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const result = JSON.parse(e.target.result);
          inventory = result.inventory || [];
          discounts = result.discounts || [];
          saveData();
          renderProductTable();
        } catch (err) {
          alert("Invalid file format");
        }
      };
      reader.readAsText(file);
    }

    showProductForm();
  </script></body>
</html>