<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inventory Manager</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1em;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0.5em;
      text-align: center;
    }
    .header-row {
      background-color: #eee;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Inventory Manager</h1>  <!-- Product Form -->  <form id="productForm">
    <h2>Add Product</h2>
    <label>Product Name: <input type="text" id="productName" required></label>
    <label>Cost: <input type="number" step="0.01" id="productCost" required></label>
    <label>Category: <input type="text" id="productCategory" required></label>
    <label><input type="checkbox" id="hasSizes"> Has Sizes</label>
    <button type="submit">Add Product</button>
  </form>  <!-- Discount Form -->  <form id="discountForm">
    <h2>Add Discount</h2>
    <label>Description: <input type="text" id="discountDesc" required></label>
    <label>Amount: <input type="number" step="0.01" id="discountAmount" required></label>
    <label>Type:
      <select id="discountType">
        <option value="%">%</option>
        <option value="$">$</option>
      </select>
    </label>
    <button type="submit">Add Discount</button>
  </form>  <!-- Import/Export Buttons --><button onclick="exportToExcel()">Export to Excel</button> <input type="file" id="importFile" accept=".xlsx" />

  <!-- Product Table -->  <table id="productTable">
    <thead>
      <tr>
        <th>Product</th>
        <th>Cost</th>
        <th>XS</th><th>S</th><th>M</th><th>L</th><th>XL</th><th>2XL</th><th>3XL</th><th>4XL</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>  <!-- Discount Table -->  <table id="discountTable">
    <thead>
      <tr>
        <th>Description</th>
        <th>Amount</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>  <script>
    let inventory = JSON.parse(localStorage.getItem('inventory') || '{}');
    let discounts = JSON.parse(localStorage.getItem('discounts') || '[]');

    const productForm = document.getElementById('productForm');
    const discountForm = document.getElementById('discountForm');
    const productTable = document.getElementById('productTable').querySelector('tbody');
    const discountTable = document.getElementById('discountTable').querySelector('tbody');

    const sizeLabels = ["XS","S","M","L","XL","2XL","3XL","4XL"];

    function saveData() {
      localStorage.setItem('inventory', JSON.stringify(inventory));
      localStorage.setItem('discounts', JSON.stringify(discounts));
    }

    function renderProductTable() {
      productTable.innerHTML = '';
      const categories = Object.keys(inventory).sort();
      categories.forEach(category => {
        const headerRow = document.createElement('tr');
        const th = document.createElement('th');
        th.colSpan = 11;
        th.className = 'header-row';
        th.innerText = category;
        headerRow.appendChild(th);
        productTable.appendChild(headerRow);

        inventory[category].forEach((item, index) => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td contenteditable>${item.name}</td>
            <td contenteditable>${item.cost}</td>
            ${sizeLabels.map(s => `<td contenteditable>${item.sizes?.[s] || ''}</td>`).join('')}
            <td>
              <button onclick="saveProduct('${category}', ${index}, this)">Save</button>
              <button onclick="deleteProduct('${category}', ${index})">Delete</button>
            </td>
          `;
          productTable.appendChild(row);
        });
      });
    }

    function renderDiscountTable() {
      discountTable.innerHTML = '';
      const types = [...new Set(discounts.map(d => d.type))];
      types.forEach(type => {
        const headerRow = document.createElement('tr');
        const th = document.createElement('th');
        th.colSpan = 3;
        th.className = 'header-row';
        th.innerText = type === '%' ? 'Percent Off' : 'Fixed Discount';
        headerRow.appendChild(th);
        discountTable.appendChild(headerRow);

        discounts.filter(d => d.type === type).forEach((item, index) => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td contenteditable>${item.desc}</td>
            <td contenteditable>${item.amount}</td>
            <td><button onclick="deleteDiscount(${index})">Delete</button></td>
          `;
          discountTable.appendChild(row);
        });
      });
    }

    productForm.onsubmit = e => {
      e.preventDefault();
      const name = document.getElementById('productName').value;
      const cost = parseFloat(document.getElementById('productCost').value);
      const category = document.getElementById('productCategory').value;
      const hasSizes = document.getElementById('hasSizes').checked;

      if (!inventory[category]) inventory[category] = [];
      inventory[category].push({ name, cost, sizes: hasSizes ? {} : null });
      saveData();
      renderProductTable();
      productForm.reset();
    };

    discountForm.onsubmit = e => {
      e.preventDefault();
      const desc = document.getElementById('discountDesc').value;
      const amount = parseFloat(document.getElementById('discountAmount').value);
      const type = document.getElementById('discountType').value;
      discounts.push({ desc, amount, type });
      saveData();
      renderDiscountTable();
      discountForm.reset();
    };

    function saveProduct(category, index, btn) {
      const row = btn.closest('tr');
      const tds = row.querySelectorAll('td');
      const name = tds[0].innerText;
      const cost = parseFloat(tds[1].innerText);
      const sizes = {};
      sizeLabels.forEach((s, i) => sizes[s] = parseInt(tds[2 + i].innerText) || 0);
      inventory[category][index] = { name, cost, sizes };
      saveData();
    }

    function deleteProduct(category, index) {
      inventory[category].splice(index, 1);
      if (inventory[category].length === 0) delete inventory[category];
      saveData();
      renderProductTable();
    }

    function deleteDiscount(index) {
      discounts.splice(index, 1);
      saveData();
      renderDiscountTable();
    }

    function exportToExcel() {
      const ws = XLSX.utils.book_new();
      let products = [];
      Object.entries(inventory).forEach(([cat, items]) => {
        items.forEach(p => {
          const row = { Category: cat, Name: p.name, Cost: p.cost };
          if (p.sizes) sizeLabels.forEach(size => row[size] = p.sizes[size] || 0);
          products.push(row);
        });
      });
      const wsProducts = XLSX.utils.json_to_sheet(products);
      const wsDiscounts = XLSX.utils.json_to_sheet(discounts);
      XLSX.utils.book_append_sheet(ws, wsProducts, 'Products');
      XLSX.utils.book_append_sheet(ws, wsDiscounts, 'Discounts');
      XLSX.writeFile(ws, 'inventory.xlsx');
    }

    document.getElementById('importFile').addEventListener('change', function(e) {
      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const prodSheet = XLSX.utils.sheet_to_json(workbook.Sheets['Products']);
        const discSheet = XLSX.utils.sheet_to_json(workbook.Sheets['Discounts']);

        prodSheet.forEach(p => {
          if (!inventory[p.Category]) inventory[p.Category] = [];
          const sizes = {};
          sizeLabels.forEach(size => sizes[size] = parseInt(p[size]) || 0);
          inventory[p.Category].push({ name: p.Name, cost: p.Cost, sizes });
        });
        discounts = discSheet;
        saveData();
        renderProductTable();
        renderDiscountTable();
      };
      reader.readAsArrayBuffer(e.target.files[0]);
    });

    renderProductTable();
    renderDiscountTable();
  </script></body>
</html>