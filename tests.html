<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Inventory Manager</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 1rem;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 1rem;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0.5rem;
      text-align: left;
    }
    .hidden {
      display: none;
    }
    .button-group {
      margin-bottom: 1rem;
    }
    button {
      margin-right: 0.5rem;
    }
    input[type="number"] {
      width: 60px;
    }
    select {
      max-width: 120px;
    }
  </style>
</head>
<body>
  <h1>last semi-working Inventory Manager</h1>
  <div class="button-group">
    <button>Import</button>
    <button>Export</button>
    <button onclick="showInventory()">Inventory</button>
    <button onclick="showDiscounts()">Discounts</button>
  </div>

  <!-- Add Product Form -->
  <div id="product-form">
    <h2>Add Product</h2>
    <label>Category: <input type="text" id="category"/></label>
    <label>Name: <input type="text" id="name"/></label>
    <label>Price: <input type="number" id="price"/></label>
    <label>Quantity: <input type="number" id="quantity"/></label>
    <label>
      Unisex:
      <select id="unisex">
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>
    </label>
    <label>
      Has Sizes:
      <select id="hasSizes">
        <option value="No">No</option>
        <option value="Yes">Yes</option>
      </select>
    </label>
    <button onclick="addProduct()">Add Product</button>
  </div>

  <!-- Product Table -->
  <table id="product-table">
    <thead>
      <tr>
        <th>Category</th>
        <th>Name</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Unisex</th>
        <th>Sizes</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- Discount Form -->
  <div id="discount-form" class="hidden">
    <h2>Add Discount</h2>
    <label>Type:
      <select id="discount-type">
        <option value="%">% Off</option>
        <option value="$">$ Off</option>
      </select>
    </label>
    <label>Name: <input type="text" id="discount-name"/></label>
    <label>Amount: <input type="number" id="discount-amount"/></label>
    <button onclick="addDiscount()">Add Discount</button>
  </div>

  <!-- Discount Table -->
  <table id="discount-table" class="hidden">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Amount</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
  let productData = [];
  let discountData = [];

function addProduct() {
  const category = document.getElementById("category").value.trim();
  const name = document.getElementById("name").value.trim();
  const price = parseFloat(document.getElementById("price").value);
  const quantity = parseInt(document.getElementById("quantity").value);
  const unisex = document.getElementById("unisex").value;
  const hasSizes = document.getElementById("hasSizes").value;

  if (!category || !name || isNaN(price) || isNaN(quantity)) {
    alert("Please fill in all required fields correctly.");
    return;
  }

  const sizes = hasSizes === "Yes"
    ? { XS: 0, S: 0, M: 0, L: 0, XL: 0, XXL: 0, XXXL: 0, XXXXL: 0 }
    : null;

  productData.push({ category, name, price, quantity, unisex, sizes });
  displayProductTable();
  saveData();

  // Clear form inputs
  document.getElementById("category").value = "";
  document.getElementById("name").value = "";
  document.getElementById("price").value = "";
  document.getElementById("quantity").value = "";
  document.getElementById("unisex").value = "Yes";
  document.getElementById("hasSizes").value = "No";
}

  // ADDED: Load from localStorage if available
  window.addEventListener("DOMContentLoaded", () => {
    const savedProducts = localStorage.getItem("productData");
    const savedDiscounts = localStorage.getItem("discountData");
    if (savedProducts) {
      productData = JSON.parse(savedProducts);
      displayProductTable();
    }
    if (savedDiscounts) {
      discountData = JSON.parse(savedDiscounts);
      displayDiscountTable();
    }
  });

  // ADDED: Save to localStorage helper
  function saveData() {
    localStorage.setItem("productData", JSON.stringify(productData));
    localStorage.setItem("discountData", JSON.stringify(discountData));
  }

  // MODIFIED: Add product
  document.getElementById("productForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const category = document.getElementById("category").value;
    const name = document.getElementById("name").value;
    const sizes = {
      XS: parseInt(document.getElementById("xs").value) || 0,
      S: parseInt(document.getElementById("s").value) || 0,
      M: parseInt(document.getElementById("m").value) || 0,
      L: parseInt(document.getElementById("l").value) || 0,
      XL: parseInt(document.getElementById("xl").value) || 0,
    };
    productData.push({ category, name, sizes });
    displayProductTable();
    saveData(); // ADDED
    this.reset();
  });

  // MODIFIED: Delete product
  function deleteProduct(index) {
    productData.splice(index, 1);
    displayProductTable();
    saveData(); // ADDED
  }

  // MODIFIED: Update product (called after editing)
  function updateProduct(index, updatedProduct) {
    productData[index] = updatedProduct;
    displayProductTable();
    saveData(); // ADDED
  }

  // MODIFIED: Add discount
  document.getElementById("discountForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const code = document.getElementById("code").value;
    const amount = parseFloat(document.getElementById("amount").value);
    const type = document.getElementById("type").value;
    discountData.push({ code, amount, type });
    displayDiscountTable();
    saveData(); // ADDED
    this.reset();
  });

  // MODIFIED: Delete discount
  function deleteDiscount(index) {
    discountData.splice(index, 1);
    displayDiscountTable();
    saveData(); // ADDED
  }
</script>
</body>
</html>