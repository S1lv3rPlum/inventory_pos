<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Inventory Manager</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      padding: 8px;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <h1>Inventory Manager</h1>  <div>
    <button onclick="showProductSection()">Inventory</button>
    <button onclick="showDiscountSection()">Discounts</button>
  </div>  <div>
    <button onclick="exportToExcel()">Export</button>
    <input type="file" id="importFile" accept=".xlsx" onchange="importFromExcel(event)" />
  </div>  <h2 id="sectionTitle">Product Manager</h2>  <!-- Product Form -->  <div id="productForm">
    <input type="text" id="productName" placeholder="Product Name">
    <input type="text" id="productCategory" placeholder="Category">
    <label><input type="checkbox" id="hasSizes"> Has Sizes</label>
    <button onclick="addProduct()">Add Product</button>
  </div>  <!-- Discount Form -->  <div id="discountForm" class="hidden">
    <input type="text" id="discountName" placeholder="Discount Name">
    <input type="number" id="discountValue" placeholder="Amount">
    <select id="discountType">
      <option value="percent">Percent Off</option>
      <option value="fixed">Fixed Discount</option>
    </select>
    <button onclick="addDiscount()">Add Discount</button>
  </div>  <div id="productTableContainer">
    <table id="productTable">
      <thead>
        <tr><th colspan="100%">Category</th></tr>
        <tr>
          <th>Product</th>
          <th>XS</th><th>S</th><th>M</th><th>L</th><th>XL</th><th>2XL</th><th>3XL</th><th>4XL</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>  <div id="discountTableContainer" class="hidden">
    <table id="discountTable">
      <thead>
        <tr><th colspan="100%">Type</th></tr>
        <tr>
          <th>Name</th>
          <th>Value</th>
          <th>Type</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>  <script>
    let products = JSON.parse(localStorage.getItem('products') || '[]');
    let discounts = JSON.parse(localStorage.getItem('discounts') || '[]');

    function showProductSection() {
      document.getElementById('sectionTitle').innerText = 'Product Manager';
      document.getElementById('productForm').classList.remove('hidden');
      document.getElementById('discountForm').classList.add('hidden');
      document.getElementById('productTableContainer').classList.remove('hidden');
      document.getElementById('discountTableContainer').classList.add('hidden');
    }

    function showDiscountSection() {
      document.getElementById('sectionTitle').innerText = 'Discount Manager';
      document.getElementById('productForm').classList.add('hidden');
      document.getElementById('discountForm').classList.remove('hidden');
      document.getElementById('productTableContainer').classList.add('hidden');
      document.getElementById('discountTableContainer').classList.remove('hidden');
    }

    function addProduct() {
      const name = document.getElementById('productName').value;
      const category = document.getElementById('productCategory').value;
      const hasSizes = document.getElementById('hasSizes').checked;
      if (!name || !category) return;

      const sizes = hasSizes ? { XS: 0, S: 0, M: 0, L: 0, XL: 0, '2XL': 0, '3XL': 0, '4XL': 0 } : {};
      products.push({ name, category, sizes });
      localStorage.setItem('products', JSON.stringify(products));
      renderProductTable();
    }

    function addDiscount() {
      const name = document.getElementById('discountName').value;
      const value = document.getElementById('discountValue').value;
      const type = document.getElementById('discountType').value;
      if (!name || !value) return;
      discounts.push({ name, value, type });
      localStorage.setItem('discounts', JSON.stringify(discounts));
      renderDiscountTable();
    }

    function renderProductTable() {
      const table = document.querySelector('#productTable tbody');
      table.innerHTML = '';
      const sorted = [...products].sort((a,b) => a.category.localeCompare(b.category) || a.name.localeCompare(b.name));
      sorted.forEach((item, idx) => {
        const tr = document.createElement('tr');
        const nameTd = document.createElement('td');
        nameTd.contentEditable = true;
        nameTd.innerText = item.name;
        tr.appendChild(nameTd);

        ['XS','S','M','L','XL','2XL','3XL','4XL'].forEach(size => {
          const td = document.createElement('td');
          td.contentEditable = true;
          td.innerText = item.sizes?.[size] ?? '';
          tr.appendChild(td);
        });

        const actionTd = document.createElement('td');
        const delBtn = document.createElement('button');
        delBtn.innerText = 'Delete';
        delBtn.onclick = () => {
          products.splice(idx, 1);
          localStorage.setItem('products', JSON.stringify(products));
          renderProductTable();
        };
        actionTd.appendChild(delBtn);
        tr.appendChild(actionTd);
        table.appendChild(tr);
      });
    }

    function renderDiscountTable() {
      const table = document.querySelector('#discountTable tbody');
      table.innerHTML = '';
      discounts.forEach((item, idx) => {
        const tr = document.createElement('tr');
        ['name','value','type'].forEach(field => {
          const td = document.createElement('td');
          td.contentEditable = true;
          td.innerText = item[field];
          tr.appendChild(td);
        });
        const actionTd = document.createElement('td');
        const delBtn = document.createElement('button');
        delBtn.innerText = 'Delete';
        delBtn.onclick = () => {
          discounts.splice(idx, 1);
          localStorage.setItem('discounts', JSON.stringify(discounts));
          renderDiscountTable();
        };
        actionTd.appendChild(delBtn);
        tr.appendChild(actionTd);
        table.appendChild(tr);
      });
    }

    function exportToExcel() {
      const wsData = [['Type','Category','Product','XS','S','M','L','XL','2XL','3XL','4XL']];
      products.forEach(p => {
        wsData.push(['Product', p.category, p.name, ...['XS','S','M','L','XL','2XL','3XL','4XL'].map(s => p.sizes?.[s] ?? '')]);
      });
      discounts.forEach(d => {
        wsData.push(['Discount', '', d.name, d.value, d.type]);
      });
      const ws = XLSX.utils.aoa_to_sheet(wsData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Inventory');
      XLSX.writeFile(wb, 'inventory.xlsx');
    }

    function importFromExcel(e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function(event) {
        const wb = XLSX.read(event.target.result, {type: 'binary'});
        const data = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]], {header: 1});
        products = [];
        discounts = [];
        for (let row of data.slice(1)) {
          if (row[0] === 'Product') {
            products.push({
              category: row[1],
              name: row[2],
              sizes: { XS: row[3]||0, S: row[4]||0, M: row[5]||0, L: row[6]||0, XL: row[7]||0, '2XL': row[8]||0, '3XL': row[9]||0, '4XL': row[10]||0 }
            });
          } else if (row[0] === 'Discount') {
            discounts.push({ name: row[2], value: row[3], type: row[4] });
          }
        }
        localStorage.setItem('products', JSON.stringify(products));
        localStorage.setItem('discounts', JSON.stringify(discounts));
        renderProductTable();
        renderDiscountTable();
      };
      reader.readAsBinaryString(file);
    }

    renderProductTable();
    renderDiscountTable();
  </script></body>
</html>