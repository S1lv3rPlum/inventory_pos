<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Inventory</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f0f0f0; }
    .category-header { background-color: #ddd; font-weight: bold; }
    .hidden { display: none; }
    .gender-toggle input[type="checkbox"] { margin: 0 5px; }
    .edit-btn, .save-btn, .delete-btn { cursor: pointer; padding: 5px 10px; margin: 2px; }
    .edit-btn { background-color: #ffcc00; }
    .save-btn { background-color: #4CAF50; color: white; }
    .delete-btn { background-color: #f44336; color: white; }
  </style>
</head>
<body><h2>Inventory Management</h2><form id="productForm">
  <label>Category: <input type="text" id="category" required></label>
  <label>Product Name: <input type="text" id="productName" required></label>
  <label>Has Sizes: <input type="checkbox" id="hasSizes"></label>
  <span class="gender-toggle">
    Gender:
    <label>M <input type="checkbox" id="male"></label>
    <label>F <input type="checkbox" id="female"></label>
  </span>
  <button type="submit">Add Product</button>
</form><table id="inventoryTable">
  <thead>
    <tr>
      <th>Category</th>
      <th>Product</th>
      <th>Gender</th>
      <th>Size</th>
      <th>Qty</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody></tbody>
</table><script>
const form = document.getElementById("productForm");
const tableBody = document.querySelector("#inventoryTable tbody");
const sizes = ["S", "M", "L", "XL", "2XL"];
const inventory = [];

const sanitize = str => str.trim().toLowerCase();

function groupAndSortInventory() {
  // Clear table
  tableBody.innerHTML = "";
  const grouped = {};

  // Group by category then product
  inventory.forEach(item => {
    const cat = item.category;
    if (!grouped[cat]) grouped[cat] = {};
    grouped[cat][item.productName] = item;
  });

  const sortedCats = Object.keys(grouped).sort();
  sortedCats.forEach(cat => {
    // Category header
    const catRow = document.createElement("tr");
    catRow.classList.add("category-header");
    const catCell = document.createElement("td");
    catCell.colSpan = 6;
    catCell.textContent = cat;
    catRow.appendChild(catCell);
    tableBody.appendChild(catRow);

    const products = Object.keys(grouped[cat]).sort();
    products.forEach(product => {
      const data = grouped[cat][product];
      sizes.forEach((size, i) => {
        if (data.quantities[size] !== undefined) {
          const row = document.createElement("tr");

          if (i === 0) {
            const catCell = document.createElement("td");
            catCell.rowSpan = sizes.length;
            catCell.textContent = data.category;
            row.appendChild(catCell);

            const nameCell = document.createElement("td");
            nameCell.rowSpan = sizes.length;
            nameCell.textContent = data.productName;
            nameCell.classList.add("product-name-cell");
            row.appendChild(nameCell);

            const genderCell = document.createElement("td");
            genderCell.rowSpan = sizes.length;
            genderCell.innerHTML = `<label>M <input type="checkbox" class="gender-male" ${data.gender === 'M' ? 'checked' : ''} disabled></label> <label>F <input type="checkbox" class="gender-female" ${data.gender === 'F' ? 'checked' : ''} disabled></label>`;
            row.appendChild(genderCell);
          }

          const sizeCell = document.createElement("td");
          sizeCell.textContent = size;
          row.appendChild(sizeCell);

          const qtyCell = document.createElement("td");
          qtyCell.innerHTML = `<input type="number" class="qty-input" value="${data.quantities[size]}" disabled>`;
          row.appendChild(qtyCell);

          if (i === 0) {
            const actionCell = document.createElement("td");
            actionCell.rowSpan = sizes.length;
            actionCell.innerHTML = `<button class="edit-btn">Edit</button><button class="save-btn hidden">Save</button><button class="delete-btn">Delete</button>`;
            row.appendChild(actionCell);
          }

          tableBody.appendChild(row);
        }
      });
    });
  });
}

function handleGenderCheckboxes() {
  const male = document.getElementById("male");
  const female = document.getElementById("female");
  male.addEventListener("change", () => { if (male.checked) female.checked = false; });
  female.addEventListener("change", () => { if (female.checked) male.checked = false; });
}

form.addEventListener("submit", e => {
  e.preventDefault();

  const category = sanitize(document.getElementById("category").value);
  const productName = sanitize(document.getElementById("productName").value);
  const hasSizes = document.getElementById("hasSizes").checked;
  const male = document.getElementById("male").checked;
  const female = document.getElementById("female").checked;

  const gender = male ? 'M' : female ? 'F' : '';
  const quantities = {};
  if (hasSizes) {
    sizes.forEach(size => quantities[size] = 0);
  } else {
    quantities["-"] = 0;
  }

  inventory.push({ category, productName, gender, quantities });
  groupAndSortInventory();
  form.reset();
});

tableBody.addEventListener("click", e => {
  const row = e.target.closest("tr");
  const isEdit = e.target.classList.contains("edit-btn");
  const isSave = e.target.classList.contains("save-btn");
  const isDelete = e.target.classList.contains("delete-btn");

  if (!row || (!isEdit && !isSave && !isDelete)) return;

  const nameCell = row.querySelector(".product-name-cell");
  const genderCell = row.querySelector(".gender-male").closest("td");
  const qtyInputs = row.parentElement.querySelectorAll(".qty-input");
  const productName = nameCell?.textContent.trim();

  const invItem = inventory.find(item => item.productName === productName);

  if (isEdit) {
    qtyInputs.forEach(input => input.disabled = false);
    genderCell.querySelectorAll("input[type='checkbox']").forEach(cb => cb.disabled = false);
    row.parentElement.querySelector(".edit-btn").classList.add("hidden");
    row.parentElement.querySelector(".save-btn").classList.remove("hidden");
  } else if (isSave) {
    qtyInputs.forEach((input, i) => {
      const size = row.parentElement.querySelectorAll("td:nth-child(4)")[i].textContent.trim();
      invItem.quantities[size] = parseInt(input.value, 10) || 0;
      input.disabled = true;
    });
    const male = genderCell.querySelector(".gender-male").checked;
    const female = genderCell.querySelector(".gender-female").checked;
    invItem.gender = male ? 'M' : female ? 'F' : '';
    genderCell.querySelectorAll("input[type='checkbox']").forEach(cb => cb.disabled = true);
    row.parentElement.querySelector(".edit-btn").classList.remove("hidden");
    row.parentElement.querySelector(".save-btn").classList.add("hidden");
  } else if (isDelete) {
    const index = inventory.findIndex(item => item.productName === productName);
    if (index > -1) inventory.splice(index, 1);
    groupAndSortInventory();
  }
});

handleGenderCheckboxes();
</script></body>
</html>