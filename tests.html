<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inventory Manager</title>
  <style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      padding: 5px;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <h1>Inventory Manager</h1>
  <button onclick="toggleView('product')">Inventory</button>
  <button onclick="toggleView('discount')">Discounts</button>
  <button onclick="exportToExcel()">Export</button>
  <input type="file" id="importFile" accept=".xlsx" onchange="importFromExcel()" />  <h2 id="formHeader">Product Manager</h2>  <form id="productForm">
    <label>Category: <input type="text" id="category" required /></label>
    <label>Product Name: <input type="text" id="productName" required /></label>
    <label><input type="checkbox" id="hasSizes" /> Has Sizes</label>
    <button type="submit">Add Product</button>
  </form>  <form id="discountForm" class="hidden">
    <label>Product Name: <input type="text" id="discountProduct" required /></label>
    <label>Discount Amount: <input type="number" id="discountAmount" required /></label>
    <label>
      <select id="discountType">
        <option value="amount">$ Off</option>
        <option value="percent">% Off</option>
      </select>
    </label>
    <button type="submit">Add Discount</button>
  </form>  <table id="productTable">
    <thead>
      <tr>
        <th>Category</th>
        <th>Product</th>
        <th>Has Sizes</th>
        <th>XS</th><th>S</th><th>M</th><th>L</th><th>XL</th><th>2XL</th><th>3XL</th><th>4XL</th>
        <th>Edit</th><th>Delete</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>  <table id="discountTable" class="hidden">
    <thead>
      <tr>
        <th>Product</th>
        <th>Amount</th>
        <th>Type</th>
        <th>Edit</th><th>Delete</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>  <script>
    let inventory = JSON.parse(localStorage.getItem('inventory') || '[]');
    let discounts = JSON.parse(localStorage.getItem('discounts') || '[]');

    const productTable = document.querySelector('#productTable tbody');
    const discountTable = document.querySelector('#discountTable tbody');

    function saveData() {
      localStorage.setItem('inventory', JSON.stringify(inventory));
      localStorage.setItem('discounts', JSON.stringify(discounts));
    }

    function renderTables() {
      productTable.innerHTML = '';
      discountTable.innerHTML = '';
      const sorted = [...inventory].sort((a,b) => a.category.localeCompare(b.category) || a.product.localeCompare(b.product));
      for (const item of sorted) {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td contenteditable>${item.category}</td>
          <td contenteditable>${item.product}</td>
          <td>${item.hasSizes ? 'Yes' : 'No'}</td>
          ${item.hasSizes ? ['XS','S','M','L','XL','2XL','3XL','4XL'].map(size => `<td contenteditable>${item.sizes[size] || 0}</td>`).join('') : '<td colspan="8"></td>'}
          <td><button onclick="editProduct(this)">✔</button></td>
          <td><button onclick="deleteProduct('${item.product}')">❌</button></td>
        `;
        productTable.appendChild(row);
      }

      for (const item of discounts) {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td contenteditable>${item.product}</td>
          <td contenteditable>${item.amount}</td>
          <td contenteditable>${item.type}</td>
          <td><button onclick="editDiscount(this)">✔</button></td>
          <td><button onclick="deleteDiscount('${item.product}')">❌</button></td>
        `;
        discountTable.appendChild(row);
      }
    }

    function editProduct(btn) {
      const cells = btn.parentNode.parentNode.children;
      const updated = {
        category: cells[0].innerText,
        product: cells[1].innerText,
        hasSizes: cells[2].innerText === 'Yes',
        sizes: {}
      };
      if (updated.hasSizes) {
        const sizes = ['XS','S','M','L','XL','2XL','3XL','4XL'];
        sizes.forEach((size, idx) => {
          updated.sizes[size] = parseInt(cells[3 + idx].innerText) || 0;
        });
      }
      inventory = inventory.map(p => p.product === cells[1].innerText ? updated : p);
      saveData();
    }

    function editDiscount(btn) {
      const cells = btn.parentNode.parentNode.children;
      const updated = {
        product: cells[0].innerText,
        amount: parseFloat(cells[1].innerText),
        type: cells[2].innerText
      };
      discounts = discounts.map(d => d.product === cells[0].innerText ? updated : d);
      saveData();
    }

    function deleteProduct(name) {
      inventory = inventory.filter(p => p.product !== name);
      saveData();
      renderTables();
    }

    function deleteDiscount(name) {
      discounts = discounts.filter(d => d.product !== name);
      saveData();
      renderTables();
    }

    function toggleView(view) {
      const isDiscount = view === 'discount';
      document.getElementById('productForm').classList.toggle('hidden', isDiscount);
      document.getElementById('discountForm').classList.toggle('hidden', !isDiscount);
      document.getElementById('productTable').classList.toggle('hidden', isDiscount);
      document.getElementById('discountTable').classList.toggle('hidden', !isDiscount);
      document.getElementById('formHeader').innerText = isDiscount ? 'Discount Manager' : 'Product Manager';
    }

    document.getElementById('productForm').addEventListener('submit', e => {
      e.preventDefault();
      const product = {
        category: document.getElementById('category').value,
        product: document.getElementById('productName').value,
        hasSizes: document.getElementById('hasSizes').checked,
        sizes: {}
      };
      if (product.hasSizes) {
        ['XS','S','M','L','XL','2XL','3XL','4XL'].forEach(size => product.sizes[size] = 0);
      }
      inventory.push(product);
      saveData();
      renderTables();
      e.target.reset();
    });

    document.getElementById('discountForm').addEventListener('submit', e => {
      e.preventDefault();
      const discount = {
        product: document.getElementById('discountProduct').value,
        amount: parseFloat(document.getElementById('discountAmount').value),
        type: document.getElementById('discountType').value
      };
      discounts.push(discount);
      saveData();
      renderTables();
      e.target.reset();
    });

    function exportToExcel() {
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.json_to_sheet(inventory);
      XLSX.utils.book_append_sheet(wb, ws, 'Inventory');
      const ws2 = XLSX.utils.json_to_sheet(discounts);
      XLSX.utils.book_append_sheet(wb, ws2, 'Discounts');
      XLSX.writeFile(wb, 'inventory_data.xlsx');
    }

    function importFromExcel() {
      const input = document.getElementById('importFile');
      const reader = new FileReader();
      reader.onload = function (e) {
        const workbook = XLSX.read(e.target.result, { type: 'binary' });
        const inv = XLSX.utils.sheet_to_json(workbook.Sheets['Inventory']);
        const disc = XLSX.utils.sheet_to_json(workbook.Sheets['Discounts']);
        inventory = inv;
        discounts = disc;
        saveData();
        renderTables();
      };
      reader.readAsBinaryString(input.files[0]);
    }

    renderTables();
  </script></body>
</html>