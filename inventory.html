<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Inventory</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Quick style for per-size inputs */
    .size-input {
      width: 45px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>

  <header>
    <nav>
      <a href="index.html">Home</a> |
      <a href="inventory.html">Inventory</a> |
      <a href="discounts.html">Edit Discounts</a>
    </nav>
  </header>

  <main>
    <h2>Add Product</h2>
    <form id="addProductForm">
      <label>
        Product Name (required):<br/>
        <input type="text" id="productName" required />
      </label><br/>

      <label>
        Category (required):<br/>
        <select id="productCategory" required>
          <option value="">--Select--</option>
          <option value="Shirt">Shirt</option>
          <option value="Hoodie">Hoodie</option>
          <option value="Hat">Hat</option>
          <option value="Other">Other</option>
        </select>
      </label><br/>

      <label>
        Price ($) (required):<br/>
        <input type="number" id="productPrice" step="0.01" required />
      </label><br/>

      <label>
        <input type="checkbox" id="productHasSizes" />
        Has Sizes?
      </label><br/>

      <div>
        Gender:<br/>
        <label><input type="radio" name="productGender" value="M"> M</label>
        <label><input type="radio" name="productGender" value="F"> F</label>
        <label><input type="radio" name="productGender" value="" checked hidden></label>
      </div>

      <label>
        Product Image:<br/>
        <input type="file" id="productImage" accept="image/*" />
      </label><br/>

      <button type="submit" id="addproductBtn">Add Product</button>
    </form>

    <h2>Inventory List</h2>
    <div id="inventoryList"></div>
  </main>

  <script>
    const addProductForm = document.getElementById('addProductForm');
    const inventoryList = document.getElementById('inventoryList');
    const productHasSizesCheckbox = document.getElementById('productHasSizes');

    const sizeLabels = ['S', 'M', 'L', 'XL', '2XL'];

    const createTableHeader = () => {
      const header = document.createElement('thead');
      const row = document.createElement('tr');
      ['Name', 'Category', 'Price', 'Gender', ...sizeLabels, 'Actions'].forEach(text => {
        const th = document.createElement('th');
        th.textContent = text;
        row.appendChild(th);
      });
      header.appendChild(row);
      return header;
    };

    const createTableRow = (product) => {
      const row = document.createElement('tr');
      const fields = ['name', 'category', 'price', 'gender'];

      fields.forEach(field => {
        const td = document.createElement('td');
        td.textContent = product[field] || '';
        row.appendChild(td);
      });

      sizeLabels.forEach(size => {
        const td = document.createElement('td');
        td.textContent = product.sizes?.[size] || '';
        row.appendChild(td);
      });

      const actionTd = document.createElement('td');

      const editBtn = document.createElement('button');
      editBtn.textContent = 'Edit';
      editBtn.onclick = () => toggleEditMode(row, true);

      const saveBtn = document.createElement('button');
      saveBtn.textContent = 'Save';
      saveBtn.classList.add('hidden');
      saveBtn.onclick = () => toggleEditMode(row, false);

      const deleteBtn = document.createElement('button');
      deleteBtn.textContent = 'Delete';
      deleteBtn.onclick = () => row.remove();

      actionTd.append(editBtn, saveBtn, deleteBtn);
      row.appendChild(actionTd);

      return row;
    };

    const toggleEditMode = (row, isEditing) => {
      const cells = row.querySelectorAll('td');
      const fieldCount = 4 + sizeLabels.length;
      for (let i = 0; i < fieldCount; i++) {
        const cell = cells[i];
        if (isEditing) {
          const input = document.createElement('input');
          input.value = cell.textContent;
          input.className = i >= 4 ? 'size-input' : '';
          if (i === 3) { // gender
            const male = document.createElement('input');
            male.type = 'radio';
            male.name = `gender-${row.rowIndex}`;
            male.value = 'M';
            if (cell.textContent === 'M') male.checked = true;

            const female = document.createElement('input');
            female.type = 'radio';
            female.name = `gender-${row.rowIndex}`;
            female.value = 'F';
            if (cell.textContent === 'F') female.checked = true;

            cell.innerHTML = '';
            cell.append('M:', male, ' F:', female);
          } else {
            cell.innerHTML = '';
            cell.appendChild(input);
          }
        } else {
          if (i === 3) { // gender
            const radios = cells[i].querySelectorAll('input[type=radio]');
            const selected = [...radios].find(r => r.checked);
            cells[i].textContent = selected ? selected.value : '';
          } else {
            const input = cells[i].querySelector('input');
            cells[i].textContent = input ? input.value : '';
          }
        }
      }

      const [editBtn, saveBtn] = row.querySelectorAll('button');
      editBtn.classList.toggle('hidden', isEditing);
      saveBtn.classList.toggle('hidden', !isEditing);
    };

    const buildTable = () => {
      inventoryList.innerHTML = '';
      const table = document.createElement('table');
      table.appendChild(createTableHeader());
      const tbody = document.createElement('tbody');
      products.forEach(p => tbody.appendChild(createTableRow(p)));
      table.appendChild(tbody);
      inventoryList.appendChild(table);
    };

    const products = [];

    addProductForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const name = document.getElementById('productName').value.trim();
      const category = document.getElementById('productCategory').value;
      const price = document.getElementById('productPrice').value.trim();
      const gender = document.querySelector('input[name="productGender"]:checked')?.value || '';

      const hasSizes = productHasSizesCheckbox.checked;
      const sizes = {};

      if (hasSizes) {
        sizeLabels.forEach(size => {
          const qty = prompt(`Enter quantity for size ${size}:`, '0');
          sizes[size] = qty || '';
        });
      }

      products.push({ name, category, price, gender, sizes });
      buildTable();
      addProductForm.reset();
    });
  </script>
</body>
</html>